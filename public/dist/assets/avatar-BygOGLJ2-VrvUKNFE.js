import{j as W,z as me,H as te}from"./button-BD6I5F21-BCIxP22E.js";import{b as ve,g as ge,z as ye,f as q,R as be}from"./wrapEmojiText-DJXpRYaz-DsSuZO2C.js";import{F as Ce,a7 as $,v as ne,j as Ee,G as X,R as M,s as Le,z as we,N as Se,aJ as Ae,S as xe,a9 as Y,f as ie,bg as S,bb as D,b5 as ke,bS as Pe,u as Oe,af as V,b9 as R,as as Ne,cb as Te,cj as Fe}from"./index-p16BOqnp.js";import{_ as N,U as Ie}from"./page-VE9OcG0U-aQMl6CMd.js";import{T as $e}from"./scrollable-DoUmbSw--CLoL6L-W.js";function Me(n){if(n.key==="Enter"&&!Ae&&!n.isComposing){if(xe.settings.sendShortcut==="enter")return n.shiftKey||n.ctrlKey||n.metaKey?void 0:!0;{const t=Y?n.metaKey:n.ctrlKey;if(n.shiftKey||(Y?n.ctrlKey:n.metaKey))return;if(t)return!0}}return!1}function pt(n){n.requestFullscreen?n.requestFullscreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.webkitRequestFullscreen?n.webkitRequestFullscreen():n.msRequestFullscreen&&n.msRequestFullscreen()}function mt(){document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()}function Re(n,t,e){const s=e?e.add(n):n.addEventListener.bind(n);"webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange".split(" ").forEach(i=>{s(i,t,!1)})}function se(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement}function vt(){return!!se()}const Be=(n,t={})=>{const e=n==null?void 0:n.split(" ");return te("btn-icon"+((e==null?void 0:e.length)>1?" "+e.slice(1).join(" "):""),{icon:(e==null?void 0:e[0])||void 0,...t})},He=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"],je=new Set(["className","value","readOnly","formNoValidate","isMap","noModule","playsInline",...He]),De=new Set(["innerHTML","textContent","innerText","children"]),Ue=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),ze=Object.assign(Object.create(null),{class:"className",formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1}});function Ge(n,t){const e=ze[n];return typeof e=="object"?e[t]?e.$:void 0:e}const Ke=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),_e=new Set(["altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignObject","g","glyph","glyphRef","hkern","image","line","linearGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","set","stop","svg","switch","symbol","text","textPath","tref","tspan","use","view","vkern"]),We={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"};function qe(n,t,e){let s=e.length,i=t.length,r=s,a=0,o=0,c=t[i-1].nextSibling,h=null;for(;a<i||o<r;){if(t[a]===e[o]){a++,o++;continue}for(;t[i-1]===e[r-1];)i--,r--;if(i===a){const u=r<s?o?e[o-1].nextSibling:e[r-o]:c;for(;o<r;)n.insertBefore(e[o++],u)}else if(r===o)for(;a<i;)(!h||!h.has(t[a]))&&t[a].remove(),a++;else if(t[a]===e[r-1]&&e[o]===t[i-1]){const u=t[--i].nextSibling;n.insertBefore(e[o++],t[a++].nextSibling),n.insertBefore(e[--r],u),t[i]=e[r]}else{if(!h){h=new Map;let d=o;for(;d<r;)h.set(e[d],d++)}const u=h.get(t[a]);if(u!=null)if(o<u&&u<r){let d=a,m=1,y;for(;++d<i&&d<r&&!((y=h.get(t[d]))==null||y!==u+m);)m++;if(m>u-o){const k=t[a];for(;o<u;)n.insertBefore(e[o++],k)}else n.replaceChild(e[o++],t[a++])}else a++;else t[a++].remove()}}}const J="_$DX_DELEGATE";function Xe(n,t,e,s={}){let i;return ie(r=>{i=r,t===document?n():H(t,n(),t.firstChild?null:void 0,e)},s.owner),()=>{i(),t.textContent=""}}function gt(n,t,e){let s;const i=()=>{const a=document.createElement("template");return a.innerHTML=n,e?a.content.firstChild.firstChild:a.content.firstChild},r=t?()=>D(()=>document.importNode(s||(s=i()),!0)):()=>(s||(s=i())).cloneNode(!0);return r.cloneNode=r,r}function Ye(n,t=window.document){const e=t[J]||(t[J]=new Set);for(let s=0,i=n.length;s<i;s++){const r=n[s];e.has(r)||(e.add(r),t.addEventListener(r,st))}}function B(n,t,e){e==null?n.removeAttribute(t):n.setAttribute(t,e)}function Ve(n,t,e,s){s==null?n.removeAttributeNS(t,e):n.setAttributeNS(t,e,s)}function Je(n,t){t==null?n.removeAttribute("class"):n.className=t}function Qe(n,t,e,s){if(s)Array.isArray(e)?(n[`$$${t}`]=e[0],n[`$$${t}Data`]=e[1]):n[`$$${t}`]=e;else if(Array.isArray(e)){const i=e[0];n.addEventListener(t,e[0]=r=>i.call(n,e[1],r))}else n.addEventListener(t,e)}function Ze(n,t,e={}){const s=Object.keys(t||{}),i=Object.keys(e);let r,a;for(r=0,a=i.length;r<a;r++){const o=i[r];!o||o==="undefined"||t[o]||(Q(n,o,!1),delete e[o])}for(r=0,a=s.length;r<a;r++){const o=s[r],c=!!t[o];!o||o==="undefined"||e[o]===c||!c||(Q(n,o,!0),e[o]=c)}return e}function et(n,t,e){if(!t)return e?B(n,"style"):t;const s=n.style;if(typeof t=="string")return s.cssText=t;typeof e=="string"&&(s.cssText=e=void 0),e||(e={}),t||(t={});let i,r;for(r in e)t[r]==null&&s.removeProperty(r),delete e[r];for(r in t)i=t[r],i!==e[r]&&(s.setProperty(r,i),e[r]=i);return e}function tt(n,t={},e,s){const i={};return s||S(()=>i.children=x(n,t.children,i.children)),S(()=>t.ref&&t.ref(n)),S(()=>nt(n,t,e,!0,i,!0)),i}function yt(n,t,e){return D(()=>n(t,e))}function H(n,t,e,s){if(e!==void 0&&!s&&(s=[]),typeof t!="function")return x(n,t,s,e);S(i=>x(n,t(),i,e),s)}function nt(n,t,e,s,i={},r=!1){t||(t={});for(const a in i)if(!(a in t)){if(a==="children")continue;i[a]=Z(n,a,null,i[a],e,r)}for(const a in t){if(a==="children")continue;const o=t[a];i[a]=Z(n,a,o,i[a],e,r)}}function it(n){return n.toLowerCase().replace(/-([a-z])/g,(t,e)=>e.toUpperCase())}function Q(n,t,e){const s=t.trim().split(/\s+/);for(let i=0,r=s.length;i<r;i++)n.classList.toggle(s[i],e)}function Z(n,t,e,s,i,r){let a,o,c,h,u;if(t==="style")return et(n,e,s);if(t==="classList")return Ze(n,e,s);if(e===s)return s;if(t==="ref")r||e(n);else if(t.slice(0,3)==="on:"){const d=t.slice(3);s&&n.removeEventListener(d,s),e&&n.addEventListener(d,e)}else if(t.slice(0,10)==="oncapture:"){const d=t.slice(10);s&&n.removeEventListener(d,s,!0),e&&n.addEventListener(d,e,!0)}else if(t.slice(0,2)==="on"){const d=t.slice(2).toLowerCase(),m=Ke.has(d);if(!m&&s){const y=Array.isArray(s)?s[0]:s;n.removeEventListener(d,y)}(m||e)&&(Qe(n,d,e,m),m&&Ye([d]))}else if(t.slice(0,5)==="attr:")B(n,t.slice(5),e);else if((u=t.slice(0,5)==="prop:")||(c=De.has(t))||!i&&((h=Ge(t,n.tagName))||(o=je.has(t)))||(a=n.nodeName.includes("-")))u&&(t=t.slice(5),o=!0),t==="class"||t==="className"?Je(n,e):a&&!o&&!c?n[it(t)]=e:n[h||t]=e;else{const d=i&&t.indexOf(":")>-1&&We[t.split(":")[0]];d?Ve(n,d,t,e):B(n,Ue[t]||t,e)}return e}function st(n){const t=`$$${n.type}`;let e=n.composedPath&&n.composedPath()[0]||n.target;for(n.target!==e&&Object.defineProperty(n,"target",{configurable:!0,value:e}),Object.defineProperty(n,"currentTarget",{configurable:!0,get(){return e||document}});e;){const s=e[t];if(s&&!e.disabled){const i=e[`${t}Data`];if(i!==void 0?s.call(e,i,n):s.call(e,n),n.cancelBubble)return}e=e._$host||e.parentNode||e.host}}function x(n,t,e,s,i){for(;typeof e=="function";)e=e();if(t===e)return e;const r=typeof t,a=s!==void 0;if(n=a&&e[0]&&e[0].parentNode||n,r==="string"||r==="number")if(r==="number"&&(t=t.toString()),a){let o=e[0];o&&o.nodeType===3?o.data=t:o=document.createTextNode(t),e=L(n,e,s,o)}else e!==""&&typeof e=="string"?e=n.firstChild.data=t:e=n.textContent=t;else if(t==null||r==="boolean")e=L(n,e,s);else{if(r==="function")return S(()=>{let o=t();for(;typeof o=="function";)o=o();e=x(n,o,e,s)}),()=>e;if(Array.isArray(t)){const o=[],c=e&&Array.isArray(e);if(j(o,t,e,i))return S(()=>e=x(n,o,e,s,!0)),()=>e;if(o.length===0){if(e=L(n,e,s),a)return e}else c?e.length===0?ee(n,o,s):qe(n,e,o):(e&&L(n),ee(n,o));e=o}else if(t.nodeType){if(Array.isArray(e)){if(a)return e=L(n,e,s,t);L(n,e,null,t)}else e==null||e===""||!n.firstChild?n.appendChild(t):n.replaceChild(t,n.firstChild);e=t}}return e}function j(n,t,e,s){let i=!1;for(let r=0,a=t.length;r<a;r++){let o=t[r],c=e&&e[r],h;if(!(o==null||o===!0||o===!1))if((h=typeof o)=="object"&&o.nodeType)n.push(o);else if(Array.isArray(o))i=j(n,o,c)||i;else if(h==="function")if(s){for(;typeof o=="function";)o=o();i=j(n,Array.isArray(o)?o:[o],Array.isArray(c)?c:[c])||i}else n.push(o),i=!0;else{const u=String(o);c&&c.nodeType===3&&c.data===u?n.push(c):n.push(document.createTextNode(u))}}return i}function ee(n,t,e=null){for(let s=0,i=t.length;s<i;s++)n.insertBefore(t[s],e)}function L(n,t,e,s){if(e===void 0)return n.textContent="";const i=s||document.createTextNode("");if(t.length){let r=!1;for(let a=t.length-1;a>=0;a--){const o=t[a];if(i!==o){const c=o.parentNode===n;!r&&!a?c?n.replaceChild(i,o):n.insertBefore(i,e):c&&o.remove()}else r=!0}}else n.insertBefore(i,e);return[i]}const ot="http://www.w3.org/2000/svg";function oe(n,t=!1){return t?document.createElementNS(ot,n):document.createElement(n)}function bt(n){const{useShadow:t}=n,e=document.createTextNode(""),s=()=>n.mount||document.body,i=Te();let r,a=!!Fe.context;return ke(()=>{r||(r=Pe(i,()=>R(()=>n.children)));const o=s();if(o instanceof HTMLHeadElement){const[c,h]=Oe(!1),u=()=>h(!0);ie(d=>H(o,()=>c()?d():r(),null)),V(u)}else{const c=oe(n.isSVG?"g":"div",n.isSVG),h=t&&c.attachShadow?c.attachShadow({mode:"open"}):c;Object.defineProperty(c,"_$host",{get(){return e.parentNode},configurable:!0}),H(h,r),o.appendChild(c),n.ref&&n.ref(c),V(()=>o.removeChild(c))}},void 0,{render:!a}),e}function Ct(n){const[t,e]=Ne(n,["component"]),s=R(()=>t.component);return R(()=>{const i=s();switch(typeof i){case"function":return D(()=>i(e));case"string":const r=_e.has(i),a=oe(i,r);return tt(a,e,r),a}})}const U=document.body;let A=U;const re=()=>{A=se()||U,le.reAppend()};Re(U,re);const ae=class w extends Ce{constructor(t,e={}){if(super(!1),this.element=document.createElement("div"),this.container=document.createElement("div"),this.header=document.createElement("div"),this.title=document.createElement("div"),this.element.classList.add("popup"),this.element.className="popup"+(t?" "+t:""),this.container.classList.add("popup-container","z-depth-1"),$.isDarkOverlayActive&&(this.night=!0,this.element.classList.add("night")),this.header.classList.add("popup-header"),e.title&&(this.title.classList.add("popup-title"),typeof e.title=="string"?ne(this.title,e.title):typeof e.title!="boolean"&&this.title.append(e.title),this.header.append(this.title)),this.isConfirmationNeededOnClose=e.isConfirmationNeededOnClose,this.middlewareHelper=ve(),this.listenerSetter=new ge,this.managers=w.MANAGERS,this.confirmShortcutIsSendShortcut=e.confirmShortcutIsSendShortcut,e.closable&&(this.btnClose=Be("",{noRipple:!0}),this.btnClose.classList.add("popup-close"),this.header.prepend(this.btnClose),e.onBackClick?(this.btnCloseAnimatedIcon=document.createElement("div"),this.btnCloseAnimatedIcon.classList.add("animated-close-icon"),this.btnClose.append(this.btnCloseAnimatedIcon)):this.btnClose.append(W("close")),N(this.btnClose,()=>{e.onBackClick&&this.btnCloseAnimatedIcon.classList.contains("state-back")?e.onBackClick()!==!1&&this.btnCloseAnimatedIcon.classList.remove("state-back"):this.hide()},{listenerSetter:this.listenerSetter})),this.withoutOverlay=e.withoutOverlay,this.withoutOverlay&&this.element.classList.add("no-overlay"),e.overlayClosable&&N(this.element,s=>{Ee(s.target,"popup-container")||!s.target.isConnected||this.hide()},{listenerSetter:this.listenerSetter}),e.withConfirm&&(this.btnConfirm=document.createElement("button"),this.btnConfirm.classList.add("btn-primary","btn-color-primary"),e.withConfirm!==!0&&this.btnConfirm.append(X(e.withConfirm)),this.header.append(this.btnConfirm)),this.container.append(this.header),e.body&&(this.body=document.createElement("div"),this.body.classList.add("popup-body"),this.container.append(this.body)),e.scrollable){const s=this.scrollable=new $e(this.body);if(this.attachScrollableListeners(),e.floatingHeader){this.attachScrollableListeners(this.header);const i=document.createElement("div");i.classList.add("popup-header-background"),this.header.prepend(i),this.header.classList.add("is-floating")}this.body||this.header.after(s.container)}e.footer&&(this.footer=document.createElement("div"),this.footer.classList.add("popup-footer"),(this.body||this.container).append(this.footer)),this.btnConfirmOnEnter=this.btnConfirm,this.setButtons(e.buttons),this.element.append(this.container),w.POPUPS.push(this)}setButtons(t){if(this.buttons=t,this.buttonsEl&&(this.buttonsEl.remove(),this.buttonsEl=void 0),!(t!=null&&t.length))return;const e=this.buttonsEl=document.createElement("div");e.classList.add("popup-buttons");const s=t.map(i=>{const r=document.createElement("button");if(r.className="popup-button btn"+(i.isDanger?" danger":" primary"),i.noRipple||me(r),i.text?r.append(i.text):i.langKey&&r.append(X(i.langKey,i.langArgs)),i.iconLeft||i.iconRight){const a=W(i.iconLeft||i.iconRight,"popup-button-icon",i.iconLeft?"left":"right");r.classList.add("with-icon"),i.iconLeft?r.prepend(a):r.append(a)}return N(r,async a=>{var c;let o=(c=i.callback)==null?void 0:c.call(i,a);if(o!==void 0&&o instanceof Promise){const h=ye([i.element],!0);try{o=await o}catch{o=!1}o===!1&&h()}o!==!1&&this.hide()},{listenerSetter:this.listenerSetter}),i.element=r});if(!this.btnConfirmOnEnter&&t.length===2){const i=t.find(r=>!r.isCancel);i&&(this.btnConfirmOnEnter=i.element)}t.length>=3&&e.classList.add("is-vertical-layout"),e.append(...s),this.container.append(e)}attachScrollableListeners(t){return this.scrollable.attachBorderListeners(t)}onContentUpdate(){var t,e;(e=(t=this.scrollable)==null?void 0:t.onAdditionalScroll)==null||e.call(t)}show(){this.navigationItem={type:"popup",onPop:()=>{if(this.isConfirmationNeededOnClose){const t=this.isConfirmationNeededOnClose();if(t)return Promise.resolve(t).then(()=>{this.destroy()}),!1}return this.destroy()}},M.pushItem(this.navigationItem),Le(),A.append(this.element),this.element.offsetWidth,this.element.classList.add("active"),this.onContentUpdate(),this.withoutOverlay||($.isOverlayActive=!0,q.checkAnimations2(!0)),setTimeout(()=>{this.element.classList.contains("active")&&this.listenerSetter.add(document.body)("keydown",t=>{!this.btnConfirmOnEnter||this.btnConfirmOnEnter.disabled||w.POPUPS[w.POPUPS.length-1]!==this||(this.confirmShortcutIsSendShortcut?Me(t):t.key==="Enter")&&(Ie(this.btnConfirmOnEnter),we(t))})},0)}hide(){this.destroyed||!this.navigationItem||M.backByItem(this.navigationItem)}hideWithCallback(t){this.addEventListener("closeAfterTimeout",t),this.hide()}forceHide(){return this.destroy()}destroy(){this.destroyed||(this.destroyed=!0,this.dispatchEvent("close"),this.element.classList.add("hiding"),this.element.classList.remove("active"),this.listenerSetter.removeAll(),this.middlewareHelper.destroy(),this.withoutOverlay||($.isOverlayActive=!1),M.removeItem(this.navigationItem),this.navigationItem=void 0,Se(w.POPUPS,this),re(),setTimeout(()=>{var t;this.element.remove(),this.dispatchEvent("closeAfterTimeout"),this.cleanup(),(t=this.scrollable)==null||t.destroy(),this.withoutOverlay||q.checkAnimations2(!1)},250))}appendSolid(t){const e=document.createElement("div");(this.scrollable||this.body).append(e);const s=Xe(t,e);this.addEventListener("closeAfterTimeout",s)}static reAppend(){this.POPUPS.forEach(t=>{const{element:e,container:s}=t,i=e.parentElement;i&&i!==A&&A!==s&&A.append(e)})}static getPopups(t){return this.POPUPS.filter(e=>e instanceof t)}static createPopup(t,...e){return new t(...e)}};ae.POPUPS=[];let le=ae;const Et=n=>(n.find(t=>t.isCancel)||n.push({langKey:"Cancel",isCancel:!0}),n);function rt(n,t){let e,s,i,r=0,a=0,o=0,c=0,h=0;const u=4,d={},m=50,y=200,k=200;n.complete?z():n.onload=z;function ce(){s.removeEventListener("mousedown",P),s.removeEventListener("touchstart",P),s.removeEventListener("wheel",_),document.removeEventListener("mouseup",b),document.removeEventListener("touchend",b),document.removeEventListener("mousemove",C),document.removeEventListener("touchmove",C),document.removeEventListener("keypress",K),e.remove(),s.remove(),i.remove()}function de(){s.addEventListener("mousedown",P,!1),s.addEventListener("touchstart",P,!1),s.addEventListener("wheel",_,!1),document.addEventListener("keypress",K,!1)}function z(){n.classList.add("crop-blur"),n.draggable=!1,i=new Image,i.src=n.src,i.draggable=!1,i.classList.add("crop-overlay-image"),t||(t=document.createElement("canvas")),e=document.createElement("div"),e.classList.add("crop-component"),s=document.createElement("div"),s.classList.add("crop-overlay");const l=document.createElement("div");l.classList.add("crop-overlay-color"),e.appendChild(s),n.parentNode.appendChild(e),e.appendChild(i),e.appendChild(n),e.appendChild(l),s.appendChild(i),i.style.maxWidth=n.width+"px",h=n.naturalWidth/n.offsetWidth;const f=n.offsetWidth/2-y/2,p=n.offsetHeight/2-k/2;G(y,k),T(f,p),F(f,p),de()}function G(l,f){o=l*h,c=f*h,s.style.width=l+"px",s.style.height=f+"px"}function T(l,f){a=f*h,r=l*h,i.style.top=-f+"px",i.style.left=-l+"px"}function F(l,f){s.style.top=f+"px",s.style.left=l+"px"}function he(l){d.container_width=s.offsetWidth,d.container_height=s.offsetHeight,d.container_left=s.offsetLeft,d.container_top=s.offsetTop,d.mouse_x=(l.clientX||l.pageX||l.touches&&l.touches[0].clientX)+window.scrollX,d.mouse_y=(l.clientY||l.pageY||l.touches&&l.touches[0].clientY)+window.scrollY}function I(l){l=l*Math.PI*2;const f=Math.floor(s.clientWidth+l),p=Math.floor(s.clientHeight+l),v=i.clientWidth,O=i.clientHeight;let g,E;if(f<m||f>v)return;g=s.offsetLeft-l/2,E=s.offsetTop-l/2;const fe=g+f,pe=E+p;g<0&&(g=0),E<0&&(E=0),!(fe>v)&&(pe>O||(G(f,f),T(g,E),F(g,E)))}function K(l){switch(l.preventDefault(),String.fromCharCode(l.charCode)){case"+":I(u);break;case"-":I(-u);break}}function _(l){l.preventDefault(),I(l.deltaY>0?1:-1)}function P(l){l.preventDefault(),l.stopPropagation(),he(l),document.addEventListener("mousemove",C),document.addEventListener("touchmove",C),document.addEventListener("mouseup",b),document.addEventListener("touchend",b)}function b(l){l.preventDefault(),document.removeEventListener("mouseup",b),document.removeEventListener("touchend",b),document.removeEventListener("mousemove",C),document.removeEventListener("touchmove",C)}function C(l){const f={x:0,y:0};l.preventDefault(),l.stopPropagation(),f.x=l.pageX||l.touches&&l.touches[0].pageX,f.y=l.pageY||l.touches&&l.touches[0].pageY;let p=f.x-(d.mouse_x-d.container_left),v=f.y-(d.mouse_y-d.container_top);const O=s.offsetWidth,g=s.offsetHeight;p<0?p=0:p>i.offsetWidth-O&&(p=i.offsetWidth-O),v<0?v=0:v>i.offsetHeight-g&&(v=i.offsetHeight-g),T(p,v),F(p,v)}function ue(){t.width=o,t.height=c,t.getContext("2d").drawImage(n,r,a,o,c,0,0,o,c)}return{crop:ue,removeHandlers:ce}}function at(n,t){return new Promise(e=>{const s=new FileReader;s.addEventListener("loadend",i=>{e(i.target.result)}),s[t](n)})}function lt(n){return at(n,"readAsDataURL")}class Lt extends le{constructor(t={}){super("popup-avatar",{closable:!0}),this.image=new Image,this.cropper={crop:()=>{},removeHandlers:()=>{}},this.h6=document.createElement("h6"),ne(this.h6,"Popup.Avatar.Title"),this.btnClose.classList.remove("btn-icon"),this.header.append(this.h6),this.cropContainer=document.createElement("div"),this.cropContainer.classList.add("crop"),this.cropContainer.append(this.image),t.isForum&&this.cropContainer.classList.add("is-forum"),this.input=document.createElement("input"),this.input.type="file",this.input.style.display="none",this.listenerSetter.add(this.input)("change",e=>{const s=e.target.files[0];s&&lt(s).then(i=>{this.image=new Image,this.cropContainer.append(this.image),this.image.src=i,this.image.onload=()=>{this.show(),this.cropper=rt(this.image,this.canvas),this.input.value=""}})},!1),this.btnConfirm=te("btn-primary btn-color-primary btn-circle btn-crop btn-icon z-depth-1",{noRipple:!0,icon:"check"}),N(this.btnConfirm,()=>{this.cropper.crop(),this.hide(),this.canvas.toBlob(e=>{this.blob=e,this.darkenCanvas(),this.resolve()},"image/jpeg",1)},{listenerSetter:this.listenerSetter}),this.container.append(this.cropContainer,this.btnConfirm,this.input),this.addEventListener("closeAfterTimeout",()=>{this.cropper.removeHandlers(),this.image&&this.image.remove()})}resolve(){this.onCrop(()=>be.upload(this.blob))}open(t,e){this.canvas=t,this.onCrop=e,this.input.click()}darkenCanvas(){const t=this.canvas.getContext("2d");t.fillStyle="rgba(0, 0, 0, 0.3)",t.fillRect(0,0,this.canvas.width,this.canvas.height)}}export{H as $,Me as B,bt as C,Be as D,Et as E,Ze as J,Re as M,le as N,et as Q,B as R,Xe as V,Ye as X,Qe as Z,Ct as b,tt as e,yt as g,mt as m,se as o,vt as p,lt as r,pt as u,Lt as v,gt as y,Je as z};
