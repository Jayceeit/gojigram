import{z as B}from"./button-BD6I5F21-BCIxP22E.js";import{X as D,v as R,bd as K,y as N,G as k,j as C,ci as z,S as _,U as T,a9 as A,b_ as I,bc as X,Q as S,z as W}from"./index-p16BOqnp.js";import{k as F,e as Q}from"./page-VE9OcG0U-aQMl6CMd.js";import{D as M,_ as j,a9 as q,a as G,Z as H}from"./wrapEmojiText-DJXpRYaz-DsSuZO2C.js";import{T as J}from"./scrollable-DoUmbSw--CLoL6L-W.js";function O(d,e){const t=Array.isArray(e)?e:z(e);let s=d;for(const a of t)if(s=s==null?void 0:s[a],!s)break;return s}class ne{constructor(e={}){const t=this.label=document.createElement("label");t.classList.add("checkbox-field"),e.restriction&&!e.toggle&&t.classList.add("checkbox-field-restriction"),e.round&&t.classList.add("checkbox-field-round"),e.disabled&&this.toggleDisability(!0),this.listenerSetter=e.listenerSetter;const s=this.input=document.createElement("input");if(s.classList.add("checkbox-field-input"),s.type=e.asRadio?"radio":"checkbox",e.name&&(s[e.asRadio?"name":"id"]="input-"+e.name),e.checked&&(s.checked=!0),e.stateKey){let i=e.checked!==void 0;const r=()=>{if(!i)return;let o;e.stateValues?o=e.stateValues[s.checked?1:0]:(o=s.checked,e.stateValueReverse&&(o=!o)),_.managers.appStateManager.setByKey(e.stateKey,o)};!i&&D.getState().then(o=>{i=!0;const m=O(o,e.stateKey);let n;e.stateValues?n=e.stateValues.indexOf(m)===1:(n=m,e.stateValueReverse&&(n=!n)),this.setValueSilently(n)}),e.listenerSetter?e.listenerSetter.add(s)("change",r):s.addEventListener("change",r)}let a;if(e.text?(a=this.span=document.createElement("span"),a.classList.add("checkbox-caption"),R(a,e.text,e.textArgs)):t.classList.add("checkbox-without-caption"),t.append(s),e.toggle){t.classList.add("checkbox-field-toggle"),e.restriction&&t.classList.add("checkbox-field-toggle-restriction");const i=document.createElement("div");i.classList.add("checkbox-toggle");const r=document.createElement("div");r.classList.add("checkbox-toggle-circle"),i.append(r),t.append(i)}else{const i=document.createElement("div");i.classList.add("checkbox-box");const r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.classList.add("checkbox-box-check"),r.setAttributeNS(null,"viewBox","0 0 24 24");const o=document.createElementNS("http://www.w3.org/2000/svg","use");o.setAttributeNS(null,"href","#check"),o.setAttributeNS(null,"x","-1"),r.append(o);const m=document.createElement("div");m.classList.add("checkbox-box-background");const n=document.createElement("div");n.classList.add("checkbox-box-border"),i.append(n,m,r),t.append(i)}a&&t.append(a),e.withRipple?(t.classList.add("checkbox-ripple","hover-effect"),B(t,void 0,void 0,!0)):e.withHover&&t.classList.add("hover-effect")}get checked(){return this.input.checked}set checked(e){this.setValueSilently(e),F(this.input,"change")}setValueSilently(e){this.input.checked=e}isDisabled(){return this.label.classList.contains("checkbox-disabled")}toggleDisability(e){return this.label.classList.toggle("checkbox-disabled",e),this.input.disabled=e,()=>this.toggleDisability(!e)}}const E=new Map;let L=0;const w=(d,e,t="")=>{t=e.country_code+t,L=Math.max(L,t.length),E.set(t,{country:d,code:e})};function Z(d){d=d||"",E.size||T.countriesList.forEach(l=>{l.country_codes.forEach(c=>{c.prefixes?c.prefixes.forEach(h=>{w(l,c,h)}):w(l,c)})});let e=d.replace(/\D/g,"");const t=e.slice(0,L);let s;for(let l=t.length-1;l>=0&&(s=E.get(t.slice(0,l+1)),!s);--l);if(!s)return{formatted:e,country:void 0,code:void 0,leftPattern:""};const a=s.country,i=s.code.patterns||[],r=e.slice(s.code.country_code.length);let o="",m=0,n="";for(let l=i.length-1;l>=0;--l){o=i[l];const c=o.replace(/ /g,"");let h=0;for(let p=0,f=Math.min(r.length,c.length);p<f;++p)if(r[p]===c[p])h+=1.01;else if(c[p]==="X")++h;else{h=0;break}h>m&&(m=h,n=o)}o=n||o,o=o.replace(/\d/g,"X"),o=s.code.country_code+" "+o,o.split("").forEach((l,c)=>{l===" "&&e[c]!==" "&&e.length>c&&(e=e.slice(0,c)+" "+e.slice(c))});let u=o&&o.length>e.length?o.slice(e.length):"";return u&&(u=u.replace(/X/g,"â€’")),{formatted:e,country:a,code:s.code,leftPattern:u}}class ie extends M{constructor(e={}){super({label:"Contacts.PhoneNumber.Placeholder",name:"phone",...e}),this.pasted=!1,this.lastValue="",this.container.classList.add("input-field-phone");const t=this.input;if(t instanceof HTMLInputElement)t.type="tel",t.autocomplete="rr55RandomRR55";else{t.inputMode="decimal";const s=window.devicePixelRatio;if(s>1){let i;A?i=s*-.16:I&&(i=0),t.style.setProperty("--letter-spacing",i+"px")}const a=this.setValueSilently.bind(this);this.setValueSilently=i=>{a(i),j(this.input,!0)}}t.addEventListener("input",()=>{t.classList.remove("error");const s=this.value;Math.abs(s.length-this.lastValue.length)>1&&!this.pasted&&K&&this.setValueSilently(this.lastValue+s),this.pasted=!1,this.setLabel();let a,i,r="";this.value.replace(/\++/,"+")==="+"?this.setValueSilently("+"):(a=Z(this.value),i=a.formatted,a.country,r=a.leftPattern,a.code,this.setValueSilently(this.lastValue=i?"+"+i:"")),t.dataset.leftPattern=r,e.onInput&&e.onInput(a)}),t.addEventListener("paste",()=>{this.pasted=!0}),t.addEventListener("keypress",s=>{const a=s.key;if(/\D/.test(a)&&!(s.metaKey||s.ctrlKey)&&a!=="Backspace"&&!(a==="+"&&s.shiftKey))return s.preventDefault(),!1})}}let v;const V=()=>{v=T.countriesList.filter(d=>{var e;return!((e=d.pFlags)!=null&&e.hidden)}).sort((d,e)=>(d.name||d.default_name).localeCompare(e.name||e.default_name))};let y=()=>{y=void 0,V(),_.addEventListener("language_change",()=>{V()})};const P=new Set(["FT"]);function $(d,e){return y==null||y(),d=d.toLowerCase(),v.filter(t=>{if(e&&P.has(t.iso2))return!1;const s=[t.name,t.default_name,t.iso2];return s.filter(Boolean).forEach(a=>{const i=a.split(" ").filter(r=>/\w/.test(r)).map(r=>r[0]).join("");i.length>1&&s.push(i)}),!!s.filter(Boolean).find(a=>a.toLowerCase().indexOf(d)!==-1)})}class ae extends M{constructor(e={}){super({label:"Country",name:N(),...e}),this.options=e,this.hidePicker=()=>{this.hideTimeout===void 0&&(this.selectWrapper.classList.remove("active"),this.hideTimeout=window.setTimeout(()=>{this.selectWrapper.classList.add("hide"),this.hideTimeout=void 0},200))},this.selectCountryByTarget=n=>{var h,p,f;const u=n.querySelector("[data-default-name]").dataset.defaultName,l=(h=n.querySelector(".phone-code"))==null?void 0:h.innerText,c=l&&l.replace(/\D/g,"");this.value=k(u),this.lastCountrySelected=v.find(g=>g.default_name===u),this.lastCountryCodeSelected=c&&this.lastCountrySelected.country_codes.find(g=>g.country_code===c),(f=(p=this.options).onCountryChange)==null||f.call(p,this.lastCountrySelected,this.lastCountryCodeSelected),this.hidePicker()},y==null||y(),this.liMap=new Map,this.container.classList.add("input-select");const t=this.selectWrapper=document.createElement("div");t.classList.add("select-wrapper","z-depth-3","hide");const s=document.createElement("span");s.classList.add("arrow","arrow-down"),this.container.append(s);const a=document.createElement("ul");t.appendChild(a),new J(t);let i=()=>{i=null,v.forEach(n=>{if(e.noPhoneCodes&&P.has(n.iso2))return;const u=q(n.iso2),l=[];for(let c=0,h=Math.min(n.country_codes.length,e.noPhoneCodes?1:1/0);c<h;++c){const p=n.country_codes[c],f=document.createElement("li"),g=G(u);if(X){const b=document.createElement("span");S(b,g),f.append(b)}else S(f,g);const x=k(n.default_name);if(x.dataset.defaultName=n.default_name,f.append(x),!e.noPhoneCodes){const b=document.createElement("span");b.classList.add("phone-code"),b.innerText="+"+p.country_code,f.appendChild(b)}l.push(f),a.append(f)}this.liMap.set(n.iso2,l)}),a.addEventListener("mousedown",n=>{if(n.button!==0)return;const u=H(n.target,"LI");this.selectCountryByTarget(u)}),this.container.appendChild(t)};i(),this.input.addEventListener("focus",n=>{i?i():v.forEach(u=>{const l=this.liMap.get(u.iso2);l&&l.forEach(c=>c.style.display="")}),clearTimeout(this.hideTimeout),this.hideTimeout=void 0,t.classList.remove("hide"),t.offsetWidth,t.classList.add("active"),this.select(),Q({container:C(this.container,"scrollable-y"),element:this.input,position:"start",margin:4}),setTimeout(()=>{r||(document.addEventListener("mousedown",o,{capture:!0}),r=!0)},0)});let r=!1;const o=n=>{C(n.target,"input-select")||n.target!==this.input&&(this.hidePicker(),document.removeEventListener("mousedown",o,{capture:!0}),r=!1)},m=n=>{const u=n.key;if(n.ctrlKey||u==="Control")return!1;const l=new Set($(this.value).map(c=>c.iso2));this.liMap.forEach((c,h)=>{c.forEach(p=>p.style.display=l.has(h)?"":"none")}),l.size?l.size===1&&u==="Enter"&&(W(n),this.selectCountryByTarget(this.liMap.get([...l][0])[0])):v.forEach(c=>{const h=this.liMap.get(c.iso2);h&&h.forEach(p=>p.style.display="")})};this.input.addEventListener("keyup",m),this.input.addEventListener("keydown",n=>{n.key==="Enter"&&m(n)}),s.addEventListener("mousedown",n=>{this.input.matches(":focus")?(this.hidePicker(),this.input.blur()):(n.cancelBubble=!0,n.preventDefault(),this.input.focus())})}getSelected(){return{country:this.lastCountrySelected,code:this.lastCountryCodeSelected}}selectCountryByIso2(e){this.selectCountryByTarget(this.liMap.get(e)[0])}override(e,t,s){var a,i;this.setValueSilently(e?k(e.default_name):s),this.lastCountrySelected=e,this.lastCountryCodeSelected=t,(i=(a=this.options).onCountryChange)==null||i.call(a,this.lastCountrySelected,this.lastCountryCodeSelected)}}export{O as J,Z as Q,$ as Y,ne as a,ie as i,ae as n};
